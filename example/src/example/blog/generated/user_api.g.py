"""Generated by django-coalesce at 2024-06-07T05:44:05Z. DO NOT EDIT."""

from django.shortcuts import get_object_or_404
from ninja import Router, Schema

from blog.models import User


router = Router()


class UserIn(Schema):
    email: str


class UserOut(Schema):
    id: int
    email: str


@router.post("/", response=UserOut)
def create_user(request, payload: UserIn):
    user = User.objects.create(**payload.dict())
    return {"id": user.id}


@router.get("/{user_id}/", response=UserOut)
def get_user(request, user_id: int):
    user = get_object_or_404(User, id=user_id)
    return user


@router.get("/", response=list[UserOut])
def list_users(request):
    users = User.objects.all()
    return users


@router.put("/{user_id}/")
def update_user(request, user_id: int, payload: UserIn):
    user = get_object_or_404(User, id=user_id)
    for attr, value in payload.dict().items():
        setattr(user, attr, value)
    user.save()
    return {"success": True}


@router.delete("/{user_id}/")
def delete_user(request, user_id: int):
    user = get_object_or_404(User, id=user_id)
    user.delete()
    return {"success": True}
